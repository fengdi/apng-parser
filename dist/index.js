for(var r=new Uint32Array(256),a=0;a<256;a++){for(var e=a,t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;r[a]=e}var n=new Uint8Array([137,80,78,71,13,10,26,10]),u=function(r,a){var e=8;do{var t=s(r,e),n=h(r,e+4,4),u=a(n,r,e,t);e+=12+t}while(!1!==u&&"IEND"!=n&&e<r.length)},s=function(r,a){var e=0;e+=r[0+a]<<24>>>0;for(var t=1;t<4;t++)e+=r[t+a]<<8*(3-t);return e},i=function(r,a){for(var e=0,t=0;t<2;t++)e+=r[t+a]<<8*(1-t);return e},f=function(r,a){return r[a]},o=function(r,a,e){var t=new Uint8Array(e);return t.set(r.subarray(a,a+e)),t},h=function(r,a,e){var t=Array.prototype.slice.call(r.subarray(a,a+e));return String.fromCharCode.apply(String,t)},l=function(r){return[r>>>24&255,r>>>16&255,r>>>8&255,255&r]},c=function(a,e){var t=a.length+e.length,n=new Uint8Array(new ArrayBuffer(t+8));n.set(l(e.length),0),n.set(function(r){for(var a=[],e=0;e<r.length;e++)a.push(r.charCodeAt(e));return a}(a),4),n.set(e,8);var u=function(a,e,t){for(var n=-1,u=e=e||0,s=e+(t=t||a.length-e);u<s;u++)n=n>>>8^r[255&(n^a[u])];return-1^n}(n,4,t);return n.set(l(u),t+4),n};module.exports=function(r){for(var a=new Uint8Array(r),e=0;e<n.length;e++)if(n[e]!=a[e])return void reject("Not a PNG file (invalid file signature)");var t=!1;if(u(a,function(r){return"acTL"!=r||(t=!0,!1)}),t){var h=[],d=[],y=null,v=null,p={playTime:0,frames:[]};if(u(a,function(r,a,e,t){switch(r){case"IHDR":y=a.subarray(e+8,e+8+t),p.width=s(a,e+8),p.height=s(a,e+12);break;case"acTL":p.numPlays=s(a,e+8+4);break;case"fcTL":v&&p.frames.push(v),(v={}).width=s(a,e+8+4),v.height=s(a,e+8+8),v.left=s(a,e+8+12),v.top=s(a,e+8+16);var n=i(a,e+8+20),u=i(a,e+8+22);0==u&&(u=100),v.delay=1e3*n/u,v.delay<=10&&(v.delay=100),p.playTime+=v.delay,v.disposeOp=f(a,e+8+24),v.blendOp=f(a,e+8+25),v.dataParts=[];break;case"fdAT":v&&v.dataParts.push(a.subarray(e+8+4,e+8+t));break;case"IDAT":v&&v.dataParts.push(a.subarray(e+8,e+8+t));break;case"IEND":d.push(o(a,e,12+t));break;default:h.push(o(a,e,12+t))}}),v&&p.frames.push(v),0!=p.frames.length){for(var g=h,m=d,A=function(){for(v=p.frames[w],(b=[]).push(n),y.set(l(v.width),0),y.set(l(v.height),4),b.push(c("IHDR",y)),b.push(g),P=0;P<v.dataParts.length;P++)b.push(c("IDAT",v.dataParts[P]));b.push(m);var r=new Uint8Array;b.flat().forEach(function(a){var e=[].concat(Array.from(r),Array.from(a));r=new Uint8Array(e)}),delete v.dataParts,v.data=r},w=0;w<p.frames.length;w++){var b,P;A()}return p}reject("Not an animated PNG")}else reject("Not an animated PNG")};
